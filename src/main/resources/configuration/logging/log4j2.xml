<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="WARN" monitorInterval="30">

    <Properties>
        <!--
            ðŸŽ¨ å¼€å‘çŽ¯å¢ƒä¸“ç”¨æ ¼å¼ï¼šå¸¦é¢œè‰²é«˜äº®
            %highlight{%-5level}: è‡ªåŠ¨æ ¹æ®çº§åˆ«å˜è‰² (Info=ç»¿, Warn=é»„, Error=çº¢)
            %style{%c{1.}}{cyan}: ç±»åç”¨é’è‰²æ˜¾ç¤º
            %t: çº¿ç¨‹å
        -->
        <Property name="CONSOLE_PATTERN">%d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %highlight{%-5level} %style{%c{1.}}{cyan} -
            %msg%n
        </Property>

        <!-- ç”Ÿäº§çŽ¯å¢ƒæ–‡ä»¶æ ¼å¼ (æ— é¢œè‰²å­—ç¬¦ï¼Œçº¯æ–‡æœ¬) -->
        <Property name="LOG_PATTERN">%d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %-5level %c{1.} - %msg%n</Property>
        <Property name="LOG_HOME">logs</Property>
        <Property name="FILE_NAME">app</Property>
    </Properties>

    <Appenders>
        <!--
            âœ… [æ–°å¢ž] æŽ§åˆ¶å° Appender
            target="SYSTEM_OUT": è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º
        -->
        <Console name="Console" target="SYSTEM_OUT">
            <!-- ç¦ç”¨ bufferedIoï¼Œå¼€å‘çŽ¯å¢ƒéœ€è¦å³æ—¶çœ‹åˆ°æ—¥å¿— -->
            <PatternLayout pattern="${CONSOLE_PATTERN}"/>
        </Console>

        <!--
           =============================================
           1. INFO Appender (å®žé™…æ˜¯å…¨é‡æ—¥å¿—)
           å»ºè®®ï¼šInfo æ–‡ä»¶åŒ…å« WARN å’Œ ERRORï¼Œè¿™æ ·åœ¨æŽ’æŸ¥é—®é¢˜æ—¶
           èƒ½çœ‹åˆ°é”™è¯¯å‘ç”Ÿå‰åŽçš„ INFO ä¸Šä¸‹æ–‡ï¼Œä¸ç”¨åœ¨ä¸¤ä¸ªæ–‡ä»¶é—´åˆ‡æ¥åˆ‡åŽ»ã€‚
           =============================================
        -->
        <RollingRandomAccessFile name="InfoFile"
                                 fileName="${LOG_HOME}/${FILE_NAME}-info.log"
                                 filePattern="${LOG_HOME}/${FILE_NAME}-info-%d{yyyy-MM-dd}-%i.log.gz">
            <!-- æ€§èƒ½å…³é”®å‚æ•° -->
            <immediateFlush>false</immediateFlush>
            <bufferSize>262144</bufferSize>

            <PatternLayout pattern="${LOG_PATTERN}"/>

            <Policies>
                <TimeBasedTriggeringPolicy interval="1"/>
                <SizeBasedTriggeringPolicy size="1 GB"/>
            </Policies>
            <DefaultRolloverStrategy max="50"/>

            <!--
                è¿‡æ»¤å™¨ç­–ç•¥ï¼š
                è¿™é‡Œæ²¡æœ‰è®¾ç½® Filterï¼Œé»˜è®¤æŽ¥å— Root ä¼ é€’è¿‡æ¥çš„æ‰€æœ‰æ—¥å¿— (INFOåŠä»¥ä¸Š)ã€‚
                å¦‚æžœä½ åªæƒ³åœ¨ Info æ–‡ä»¶é‡Œå­˜ INFO çº§åˆ« (ä¸å­˜ WARN/ERROR)ï¼Œå¯ä»¥è§£å¼€ä¸‹é¢çš„æ³¨é‡Šï¼š
            -->
            <!--
            <Filters>
                <LevelRangeFilter minLevel="INFO" maxLevel="INFO" onMatch="ACCEPT" onMismatch="DENY"/>
            </Filters>
            -->
        </RollingRandomAccessFile>

        <!--
           =============================================
           2. ERROR Appender (ä»…è®°å½• ERROR å’Œ FATAL)
           ç”¨äºŽç›‘æŽ§æŠ¥è­¦ï¼Œæ–‡ä»¶ä½“ç§¯é€šå¸¸è¾ƒå°ã€‚
           =============================================
        -->
        <RollingRandomAccessFile name="ErrorFile"
                                 fileName="${LOG_HOME}/${FILE_NAME}-error.log"
                                 filePattern="${LOG_HOME}/${FILE_NAME}-error-%d{yyyy-MM-dd}-%i.log.gz">
            <immediateFlush>false</immediateFlush>
            <bufferSize>262144</bufferSize>

            <PatternLayout pattern="${LOG_PATTERN}"/>

            <Policies>
                <TimeBasedTriggeringPolicy interval="1"/>
                <SizeBasedTriggeringPolicy size="1 GB"/>
            </Policies>
            <DefaultRolloverStrategy max="50"/>

            <!-- ðŸ”¥ å…³é”®è¿‡æ»¤å™¨ï¼šåªæŽ¥å— ERROR åŠä»¥ä¸Šçº§åˆ« -->
            <Filters>
                <ThresholdFilter level="ERROR" onMatch="ACCEPT" onMismatch="DENY"/>
            </Filters>
        </RollingRandomAccessFile>

    </Appenders>

    <Loggers>
        <!-- å¼€å‘çŽ¯å¢ƒé€šå¸¸æƒ³çœ‹ Spring å¯åŠ¨çš„è¯¦ç»†æµç¨‹ï¼Œå¯ä»¥æ”¹ä¸º INFO -->
        <Logger name="org.springframework" level="INFO"/>
        <Logger name="org.mybatis" level="DEBUG"/>

        <!-- å¼€å¯ MBG çš„è¯¦ç»†æ—¥å¿— -->
        <Logger name="org.mybatis.generator" level="DEBUG"/>

        <!-- ðŸ”¥ å…³é”®é…ç½®ï¼šå°† Mapper åŒ…çš„çº§åˆ«è®¾ä¸º DEBUG -->
        <!-- additivity="false" è¡¨ç¤ºä¸é‡å¤æ‰“å°åˆ° Rootï¼Œä½†éœ€æŒ‡å®š AppenderRef -->
        <!-- å¦‚æžœä½ æƒ³çœäº‹ï¼Œå¯ä»¥ç›´æŽ¥åŽ»æŽ‰ additivity å’Œ AppenderRefï¼Œè®©å®ƒç»§æ‰¿ Root -->
        <Logger name="thriving.softwood.mapper" level="DEBUG" additivity="false">
            <!-- å¼€å‘çŽ¯å¢ƒå¼•ç”¨ Consoleï¼Œç”Ÿäº§çŽ¯å¢ƒå¼•ç”¨ AsyncFile -->
            <AppenderRef ref="Console"/>
            <!-- å¦‚æžœæƒ³åœ¨æ–‡ä»¶é‡Œä¹Ÿçœ‹ SQLï¼ŒæŠŠ InfoFile ä¹ŸåŠ ä¸Š -->
            <!--<AppenderRef ref="InfoFile"/>-->
        </Logger>

        <!--
            Root Logger
            includeLocation="false": ä¾ç„¶å»ºè®®å…³é—­è¡Œå·ï¼Œå¦åˆ™æ–‡ä»¶å†™å…¥æ€§èƒ½ä¼šå—å½±å“ã€‚
            å¦‚æžœä½ å¼€å‘æ—¶å®žåœ¨æƒ³çœ‹è¡Œå·ï¼Œå¯ä»¥åœ¨ä¸Šé¢çš„ CONSOLE_PATTERN é‡ŒåŠ ä¸Š %L
        -->
        <Root level="INFO" includeLocation="false">
            <!--æŒ‡å®šå½“å‰çº§åˆ«æ—¥å¿—è¾“å‡ºåˆ°å“ªä¸ªè¿½åŠ å™¨é‡-->
            <!-- âœ… [æ–°å¢ž] å¼•ç”¨æŽ§åˆ¶å° -->
            <AppenderRef ref="Console"/>
            <AppenderRef ref="InfoFile"/>
            <AppenderRef ref="ErrorFile"/>
        </Root>
    </Loggers>

</Configuration>